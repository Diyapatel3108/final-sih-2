(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7873],{3998:(e,t,r)=>{"use strict";r.d(t,{$:()=>c,r:()=>i});var a=r(95155),s=r(12115),n=r(32467),l=r(83101),d=r(64269);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:c=!1,...o}=e,u=c?n.DX:"button";return(0,a.jsx)(u,{className:(0,d.cn)(i({variant:s,size:l,className:r})),ref:t,...o})});c.displayName="Button"},5320:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(14294).A)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},10480:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(95155),s=r(12115),n=r(15239),l=r(86948),d=r(3998),i=r(11186),c=r(5320),o=r(18332),u=r(51289);function f(){let[e,t]=(0,s.useState)(void 0),[r,f]=(0,s.useState)([]),[m,p]=(0,s.useState)(null),[x,h]=(0,s.useState)(null),[v,g]=(0,s.useState)(0),[y,w]=(0,s.useState)(!1),[N,j]=(0,s.useState)(null),b=(0,s.useRef)();(0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await u.N.auth.getUser();if(e){let{data:t,error:r}=await u.N.from("classes").select("*").eq("teacher_id",e.id);t&&f(t)}})()},[]),(0,s.useEffect)(()=>()=>{b.current&&clearInterval(b.current)},[]),(0,s.useEffect)(()=>(v>0?b.current=setInterval(()=>{g(e=>e-1)},1e3):(b.current&&clearInterval(b.current),m&&(p(null),h(null))),()=>{b.current&&clearInterval(b.current)}),[v,m]);let k=async()=>{if(!e)return void j("Please select a class first.");let t=r.find(t=>t.id===e);if(!t)return void j("Could not find the selected class details.");w(!0),j(null),b.current&&clearInterval(b.current);try{let r="SES-".concat(Date.now()),a={sessionId:r,classId:e,className:t.name},s=await fetch("/api/auth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionData:a})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to generate a secure token.")}let{token:n}=await s.json(),l="".concat(window.location.origin,"/student/qr-scanner?token=").concat(n),d="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=".concat(encodeURIComponent(l));p(d),h({id:r,className:t.name}),g(60)}catch(e){j(e instanceof Error?e.message:"An unknown error occurred while generating the QR code."),p(null),h(null)}finally{w(!1)}};return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Generate QR Code"}),(0,a.jsx)(l.BT,{children:"Select a class to generate a unique, time-limited QR code for attendance."})]}),(0,a.jsxs)(l.Wu,{className:"flex flex-col items-center gap-6",children:[(0,a.jsxs)("div",{className:"w-full max-w-sm space-y-4",children:[(0,a.jsxs)(i.l6,{onValueChange:t,value:e,disabled:y||v>0,children:[(0,a.jsx)(i.bq,{children:(0,a.jsx)(i.yv,{placeholder:"Select a class..."})}),(0,a.jsx)(i.gC,{children:r.map(e=>(0,a.jsx)(i.eb,{value:e.id,children:e.name},e.id))})]}),(0,a.jsxs)(d.$,{onClick:k,disabled:!e||y||v>0,className:"w-full",children:[(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4"}),y?"Generating...":v>0?"Expires in ".concat(v,"s"):"Generate QR Code"]})]}),N&&(0,a.jsxs)(o.Fc,{variant:"destructive",className:"w-full max-w-sm",children:[(0,a.jsx)("div",{}),(0,a.jsx)(o.XL,{children:"Error"}),(0,a.jsx)(o.TN,{children:N})]}),(0,a.jsx)("div",{className:"w-full flex flex-col items-center justify-center p-4 min-h-[320px]",children:m?(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,a.jsx)(n.default,{src:m,alt:"Generated QR Code",width:300,height:300,priority:!0}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"font-semibold",children:["Session for ",null==x?void 0:x.className]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Expires in ",v," seconds"]})]})]}):(0,a.jsxs)("div",{className:"w-[300px] h-[300px] bg-secondary rounded-lg flex flex-col items-center justify-center border-2 border-dashed",children:[(0,a.jsx)(c.A,{className:"w-16 h-16 text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground text-center px-4",children:x?"QR Code expired. Generate a new one.":"QR code will appear here once generated."})]})})]})]})})}},11186:(e,t,r)=>{"use strict";r.d(t,{bq:()=>f,eb:()=>h,gC:()=>x,l6:()=>o,yv:()=>u});var a=r(95155),s=r(12115),n=r(55644),l=r(59007),d=r(42614),i=r(72251),c=r(64269);let o=n.bL;n.YJ;let u=n.WT,f=s.forwardRef((e,t)=>{let{className:r,children:s,...d}=e;return(0,a.jsxs)(n.l9,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...d,children:[s,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=n.l9.displayName;let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})});m.displayName=n.PP.displayName;let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});p.displayName=n.wn.displayName;let x=s.forwardRef((e,t)=>{let{className:r,children:s,position:l="popper",...d}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...d,children:[(0,a.jsx)(m,{}),(0,a.jsx)(n.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(p,{})]})})});x.displayName=n.UC.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.JU,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=n.JU.displayName;let h=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(n.q7,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.p4,{children:s})]})});h.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=n.wv.displayName},18332:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>i,TN:()=>o,XL:()=>c});var a=r(95155),s=r(12115),n=r(83101),l=r(64269);let d=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=s.forwardRef((e,t)=>{let{className:r,variant:s,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(d({variant:s}),r),...n})});i.displayName="Alert";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});c.displayName="AlertTitle";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",r),...s})});o.displayName="AlertDescription"},51289:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var a=r(65040);let s="https://mwvoxtyheoowvqvdwzqd.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im13dm94dHloZW9vd3ZxdmR3enFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1NzQ3NjMsImV4cCI6MjA3MzE1MDc2M30.Mh2z0deL-DoOyw2BY7DneG7qQV7VOrI-Ju9Ck7PvL5I";if(!s||!n)throw Error("Supabase URL and anonymous key are required.");let l=(0,a.UU)(s,n)},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(2821),s=r(75889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},70096:(e,t,r)=>{Promise.resolve().then(r.bind(r,10480))},86948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>i,Zp:()=>l,aR:()=>d,wL:()=>u});var a=r(95155),s=r(12115),n=r(64269);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});l.displayName="Card";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});d.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});o.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"}},e=>{e.O(0,[7620,5402,8519,9566,327,5239,8441,1255,7358],()=>e(e.s=70096)),_N_E=e.O()}]);